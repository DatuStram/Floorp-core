{"version":3,"file":"content.js","sources":["../src/components/custom-shortcut-key/index.ts","../src/content/statusbar/browser-statusbar.tsx","../src/content/statusbar/context-menu.tsx","../src/content/statusbar/statusbar.tsx","../src/content/statusbar/index.tsx","../src/content/context-menu/context-menu.tsx","../src/content/context-menu/browser-context-menu.tsx","../src/content/context-menu/index.tsx","../src/content/index.ts"],"sourcesContent":["/* This Source Code Form is subject to the terms of the Mozilla Public\r\n * License, v. 2.0. If a copy of the MPL was not distributed with this\r\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\r\n\r\nimport { commands } from \"./commands\";\r\nimport { zCSKCommands, zCSKData, type CSKData } from \"./defines\";\r\nimport { checkIsSystemShortcut } from \"./utils\";\r\n\r\nexport class CustomShortcutKey {\r\n  private static instance: CustomShortcutKey;\r\n  private static windows: Window[] = [];\r\n\r\n  //this boolean disable shortcut of csk\r\n  //useful for registering\r\n  disable_csk = false;\r\n  static getInstance() {\r\n    if (!CustomShortcutKey.instance) {\r\n      CustomShortcutKey.instance = new CustomShortcutKey();\r\n    }\r\n    if (!CustomShortcutKey.windows.includes(window)) {\r\n      CustomShortcutKey.instance.startHandleShortcut(window);\r\n      CustomShortcutKey.windows.push(window);\r\n      console.log(\"add window\");\r\n    }\r\n    //@ts-ignore\r\n    Services.obs.addObserver(CustomShortcutKey.instance, \"nora-csk\");\r\n    return CustomShortcutKey.instance;\r\n  }\r\n\r\n  //@ts-ignore\r\n  observe(_subj, _topic, data: string) {\r\n    const d = zCSKCommands.safeParse(JSON.parse(data));\r\n    if (d.success) {\r\n      switch (d.data.type) {\r\n        case \"disable-csk\": {\r\n          this.disable_csk = d.data.data;\r\n          break;\r\n        }\r\n        case \"update-pref\": {\r\n          this.initCSKData();\r\n          console.log(this.cskData);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  cskData: CSKData = {};\r\n  private constructor() {\r\n    this.initCSKData();\r\n\r\n    console.warn(\"CSK Init Completed\");\r\n  }\r\n\r\n  private initCSKData() {\r\n    //TODO: safely catch\r\n    this.cskData = zCSKData.parse(\r\n      JSON.parse(\r\n        Services.prefs.getStringPref(\"floorp.browser.nora.csk.data\", \"{}\"),\r\n      ),\r\n    );\r\n  }\r\n  private startHandleShortcut(_window: Window) {\r\n    _window.addEventListener(\"keydown\", (ev) => {\r\n      if (this.disable_csk) {\r\n        console.log(\"disable-csk\");\r\n        return;\r\n      }\r\n      if (\r\n        [\"Control\", \"Alt\", \"Meta\", \"Shift\"].filter((k) => ev.key.includes(k))\r\n          .length === 0\r\n      ) {\r\n        if (checkIsSystemShortcut(ev)) {\r\n          console.warn(`This Event is registered in System: ${ev}`);\r\n          return;\r\n        }\r\n\r\n        for (const [_key, shortcutDatum] of Object.entries(this.cskData)) {\r\n          const key = _key as keyof CSKData;\r\n          const { alt, ctrl, meta, shift } = shortcutDatum!.modifiers;\r\n          if (\r\n            ev.altKey === alt &&\r\n            ev.ctrlKey === ctrl &&\r\n            ev.metaKey === meta &&\r\n            ev.shiftKey === shift &&\r\n            ev.key === shortcutDatum!.key\r\n          ) {\r\n            commands[key].command(ev);\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n}\r\n","/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\r\n * This Source Code Form is subject to the terms of the Mozilla Public\r\n * License, v. 2.0. If a copy of the MPL was not distributed with this\r\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\r\n\r\nimport { createEffect, createSignal } from \"solid-js\";\r\nimport type {} from \"solid-styled-jsx\";\r\n\r\nexport const [showStatusbar, setShowStatusbar] = createSignal(\r\n  Services.prefs.getBoolPref(\"browser.display.statusbar\", false),\r\n);\r\n\r\ncreateEffect(() => {\r\n  Services.prefs.setBoolPref(\"browser.display.statusbar\", showStatusbar());\r\n  const statuspanel_label = document.getElementById(\"statuspanel-label\");\r\n  if (showStatusbar()) {\r\n    document.getElementById(\"status-text\")?.appendChild(statuspanel_label!);\r\n  } else {\r\n    document.getElementById(\"statuspanel\")?.appendChild(statuspanel_label!);\r\n  }\r\n});\r\n\r\nexport const gFloorpStatusBar = {\r\n  init() {\r\n    window.CustomizableUI.registerArea(\"statusBar\", {\r\n      type: window.CustomizableUI.TYPE_TOOLBAR,\r\n      defaultPlacements: [\"screenshot-button\", \"fullscreen-button\"],\r\n    });\r\n    window.CustomizableUI.registerToolbarNode(\r\n      document.getElementById(\"statusBar\"),\r\n    );\r\n\r\n    //move elem to bottom of window\r\n    document.body?.appendChild(document.getElementById(\"statusBar\")!);\r\n    this.observeStatusbar();\r\n\r\n    setShowStatusbar(() =>\r\n      Services.prefs.getBoolPref(\"browser.display.statusbar\", false),\r\n    );\r\n  },\r\n\r\n  observeStatusbar() {\r\n    Services.prefs.addObserver(\"browser.display.statusbar\", () =>\r\n      setShowStatusbar(() =>\r\n        Services.prefs.getBoolPref(\"browser.display.statusbar\", false),\r\n      ),\r\n    );\r\n  },\r\n};\r\n","/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\r\n * This Source Code Form is subject to the terms of the Mozilla Public\r\n * License, v. 2.0. If a copy of the MPL was not distributed with this\r\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\r\n\r\nimport { showStatusbar, setShowStatusbar } from \"./browser-statusbar\";\r\n\r\nexport function ContextMenu() {\r\n  return (\r\n    <xul:menuitem\r\n      data-l10n-id=\"status-bar\"\r\n      label=\"Status Bar\"\r\n      type=\"checkbox\"\r\n      id=\"toggle_statusBar\"\r\n      checked={showStatusbar()}\r\n      onCommand={() => setShowStatusbar((value) => !value)}\r\n    />\r\n  );\r\n}\r\n","/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\r\n * This Source Code Form is subject to the terms of the Mozilla Public\r\n * License, v. 2.0. If a copy of the MPL was not distributed with this\r\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\r\n\r\nimport { showStatusbar } from \"./browser-statusbar\";\r\nimport statusbarStyle from \"./statusbar.pcss?inline\";\r\n\r\nexport function StatusBar() {\r\n  return (\r\n    <>\r\n      <xul:toolbar\r\n        id=\"statusBar\"\r\n        toolbarname=\"Status bar\"\r\n        customizable=\"true\"\r\n        style=\"border-top: 1px solid var(--chrome-content-separator-color)\"\r\n        class={`browser-toolbar customization-target ${\r\n          showStatusbar() ? \"\" : \"collapsed\"\r\n        }`}\r\n        mode=\"icons\"\r\n        context=\"toolbar-context-menu\"\r\n        accesskey=\"A\"\r\n      >\r\n        <xul:hbox\r\n          id=\"status-text\"\r\n          align=\"center\"\r\n          flex=\"1\"\r\n          class=\"statusbar-padding\"\r\n        />\r\n      </xul:toolbar>\r\n      <style jsx>{statusbarStyle}</style>\r\n    </>\r\n  );\r\n}\r\n","/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\r\n * This Source Code Form is subject to the terms of the Mozilla Public\r\n * License, v. 2.0. If a copy of the MPL was not distributed with this\r\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\r\n\r\nimport { insert, render } from \"@solid-xul/solid-xul\";\r\nimport { gFloorpStatusBar } from \"./browser-statusbar\";\r\nimport { ContextMenu } from \"./context-menu\";\r\nimport { StatusBar } from \"./statusbar\";\r\n\r\nexport function initStatusbar() {\r\n  render(() => <StatusBar />, document.getElementById(\"navigator-toolbox\"));\r\n  insert(\r\n    document.getElementById(\"toolbar-context-menu\"),\r\n    () => <ContextMenu />,\r\n    document.getElementById(\"viewToolbarsMenuSeparator\"),\r\n  );\r\n\r\n  // Initialize statusbar\r\n  window.gFloorpStatusBar = gFloorpStatusBar;\r\n  gFloorpStatusBar.init();\r\n}\r\n","/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\r\n * This Source Code Form is subject to the terms of the Mozilla Public\r\n * License, v. 2.0. If a copy of the MPL was not distributed with this\r\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\r\n\r\nexport function ContextMenu(id: string, l10n: string, runFunction: () => void) {\r\n  return (\r\n    <xul:menuitem\r\n      data-l10n-id={l10n}\r\n      label={l10n}\r\n      id={id}\r\n      onCommand={runFunction}\r\n    />\r\n  );\r\n}\r\n","import { insert } from \"@solid-xul/solid-xul\";\r\nimport { ContextMenu } from \"./context-menu\";\r\nimport type { JSXElement } from \"solid-js\";\r\n\r\nexport const gFloorpContextMenu: {\r\n  initialized: boolean;\r\n  checkItems: (() => void)[];\r\n  contextMenuObserver: MutationObserver;\r\n  windowModalDialogElem: XULElement;\r\n  screenShotContextMenuItems: XULElement;\r\n  contentAreaContextMenu: XULElement;\r\n  pdfjsContextMenuSeparator: XULElement;\r\n  contextMenuSeparators: NodeListOf<XULElement>;\r\n  init: () => void;\r\n  addContextBox: (\r\n    id: string,\r\n    l10n: string,\r\n    insert: string,\r\n    runFunction: () => void,\r\n    checkID: string,\r\n    checkedFunction: () => void,\r\n  ) => void;\r\n  contextMenuObserverFunc: () => void;\r\n  addToolbarContentMenuPopupSet: (xulElement: JSXElement) => void;\r\n  onPopupShowing: () => void;\r\n} = {\r\n  initialized: false,\r\n  checkItems: [],\r\n  contextMenuObserver: new MutationObserver(() =>\r\n    gFloorpContextMenu.contextMenuObserverFunc(),\r\n  ),\r\n\r\n  get windowModalDialogElem() {\r\n    return document.getElementById(\"window-modal-dialog\") as XULElement;\r\n  },\r\n  get screenShotContextMenuItems() {\r\n    return document.getElementById(\"context-take-screenshot\") as XULElement;\r\n  },\r\n  get contentAreaContextMenu() {\r\n    return document.getElementById(\"contentAreaContextMenu\") as XULElement;\r\n  },\r\n  get pdfjsContextMenuSeparator() {\r\n    return document.getElementById(\"context-sep-pdfjs-selectall\") as XULElement;\r\n  },\r\n  get contextMenuSeparators() {\r\n    return document.querySelectorAll(\r\n      \"#contentAreaContextMenu > menuseparator\",\r\n    ) as NodeListOf<XULElement>;\r\n  },\r\n\r\n  init() {\r\n    if (this.initialized) {\r\n      return;\r\n    }\r\n    gFloorpContextMenu.contentAreaContextMenu.addEventListener(\r\n      \"popupshowing\",\r\n      gFloorpContextMenu.onPopupShowing,\r\n    );\r\n    this.initialized = true;\r\n  },\r\n\r\n  addContextBox(\r\n    id,\r\n    l10n,\r\n    insertElementId,\r\n    runFunction,\r\n    checkID,\r\n    checkedFunction,\r\n  ) {\r\n    const contextMenu = ContextMenu(id, l10n, runFunction);\r\n    const targetNode = document.getElementById(checkID) as XULElement;\r\n    const insertElement = document.getElementById(\r\n      insertElementId,\r\n    ) as XULElement;\r\n\r\n    insert(this.contentAreaContextMenu, () => contextMenu, insertElement);\r\n    this.contextMenuObserver.observe(targetNode, { attributes: true });\r\n    this.checkItems.push(checkedFunction);\r\n    this.contextMenuObserverFunc();\r\n  },\r\n\r\n  contextMenuObserverFunc() {\r\n    for (const checkItem of this.checkItems) {\r\n      checkItem();\r\n    }\r\n  },\r\n\r\n  addToolbarContentMenuPopupSet(JSXElem) {\r\n    insert(document.body, JSXElem, this.windowModalDialogElem);\r\n  },\r\n\r\n  onPopupShowing() {\r\n    if (!gFloorpContextMenu.screenShotContextMenuItems.hidden) {\r\n      gFloorpContextMenu.pdfjsContextMenuSeparator.hidden = false;\r\n\r\n      const nextSibling = gFloorpContextMenu.screenShotContextMenuItems\r\n        .nextSibling as XULElement;\r\n      if (nextSibling) {\r\n        nextSibling.hidden = false;\r\n      }\r\n    }\r\n\r\n    (async () => {\r\n      for (const contextMenuSeparator of gFloorpContextMenu.contextMenuSeparators) {\r\n        if (\r\n          contextMenuSeparator.nextSibling.hidden &&\r\n          contextMenuSeparator.previousSibling.hidden &&\r\n          contextMenuSeparator.id !== \"context-sep-navigation\" &&\r\n          contextMenuSeparator.id !== \"context-sep-pdfjs-selectall\"\r\n        ) {\r\n          contextMenuSeparator.hidden = true;\r\n        }\r\n      }\r\n    })();\r\n  },\r\n};\r\n","/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\r\n * This Source Code Form is subject to the terms of the Mozilla Public\r\n * License, v. 2.0. If a copy of the MPL was not distributed with this\r\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\r\n\r\nimport { gFloorpContextMenu } from \"./browser-context-menu\";\r\n\r\nexport function initBrowserContextMenu() {\r\n  gFloorpContextMenu.init();\r\n}\r\n","/* This Source Code Form is subject to the terms of the Mozilla Public\r\n * License, v. 2.0. If a copy of the MPL was not distributed with this\r\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\r\n\r\nimport { CustomShortcutKey } from \"../components/custom-shortcut-key\";\r\nimport { initStatusbar } from \"./statusbar\";\r\nimport { initBrowserContextMenu } from \"./context-menu\";\r\n\r\nCustomShortcutKey.getInstance();\r\n\r\nwindow.SessionStore.promiseInitialized.then(() => {\r\n    initBrowserContextMenu();\r\n    initStatusbar();\r\n});\r\n"],"names":["showStatusbar","setShowStatusbar","createSignal","Services","prefs","getBoolPref","createEffect","setBoolPref","statuspanel_label","document","getElementById","appendChild","gFloorpStatusBar","init","CustomizableUI","registerArea","type","window","TYPE_TOOLBAR","defaultPlacements","registerToolbarNode","body","observeStatusbar","addObserver","ContextMenu","_el$","_$createElement","_$setProp","value","_$effect","_$p","StatusBar","_el$2","_$insertNode","_el$3","_$insert","statusbarStyle","initStatusbar","_$createComponent","insert","id","l10n","runFunction","gFloorpContextMenu","initialized","checkItems","contextMenuObserver","MutationObserver","contextMenuObserverFunc","windowModalDialogElem","screenShotContextMenuItems","contentAreaContextMenu","pdfjsContextMenuSeparator","contextMenuSeparators","querySelectorAll","addEventListener","onPopupShowing","addContextBox","insertElementId","checkID","checkedFunction","contextMenu","targetNode","insertElement","observe","attributes","push","checkItem","addToolbarContentMenuPopupSet","JSXElem","hidden","nextSibling","contextMenuSeparator","previousSibling","initBrowserContextMenu"],"mappings":"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"}