{"version":3,"file":"content.js","sources":["../src/components/custom-shortcut-key/index.ts","../src/content/statusbar/browser-statusbar.tsx","../src/content/statusbar/context-menu.tsx","../src/content/statusbar/statusbar.tsx","../src/content/statusbar/index.tsx","../src/content/context-menu/context-menu.tsx","../src/content/context-menu/browser-context-menu.tsx","../src/content/context-menu/index.tsx","../src/content/index.ts"],"sourcesContent":["/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { commands } from \"./commands\";\nimport { zCSKCommands, zCSKData, type CSKData } from \"./defines\";\nimport { checkIsSystemShortcut } from \"./utils\";\n\nexport class CustomShortcutKey {\n  private static instance: CustomShortcutKey;\n  private static windows: Window[] = [];\n\n  //this boolean disable shortcut of csk\n  //useful for registering\n  disable_csk = false;\n  static getInstance() {\n    if (!CustomShortcutKey.instance) {\n      CustomShortcutKey.instance = new CustomShortcutKey();\n    }\n    if (!CustomShortcutKey.windows.includes(window)) {\n      CustomShortcutKey.instance.startHandleShortcut(window);\n      CustomShortcutKey.windows.push(window);\n      console.log(\"add window\");\n    }\n    //@ts-ignore\n    Services.obs.addObserver(CustomShortcutKey.instance, \"nora-csk\");\n    return CustomShortcutKey.instance;\n  }\n\n  //@ts-ignore\n  observe(_subj, _topic, data: string) {\n    const d = zCSKCommands.safeParse(JSON.parse(data));\n    if (d.success) {\n      switch (d.data.type) {\n        case \"disable-csk\": {\n          this.disable_csk = d.data.data;\n          break;\n        }\n        case \"update-pref\": {\n          this.initCSKData();\n          console.log(this.cskData);\n          break;\n        }\n      }\n    }\n  }\n\n  cskData: CSKData = {};\n  private constructor() {\n    this.initCSKData();\n\n    console.warn(\"CSK Init Completed\");\n  }\n\n  private initCSKData() {\n    //TODO: safely catch\n    this.cskData = zCSKData.parse(\n      JSON.parse(\n        Services.prefs.getStringPref(\"floorp.browser.nora.csk.data\", \"{}\"),\n      ),\n    );\n  }\n  private startHandleShortcut(_window: Window) {\n    _window.addEventListener(\"keydown\", (ev) => {\n      if (this.disable_csk) {\n        console.log(\"disable-csk\");\n        return;\n      }\n      if (\n        [\"Control\", \"Alt\", \"Meta\", \"Shift\"].filter((k) => ev.key.includes(k))\n          .length === 0\n      ) {\n        if (checkIsSystemShortcut(ev)) {\n          console.warn(`This Event is registered in System: ${ev}`);\n          return;\n        }\n\n        for (const [_key, shortcutDatum] of Object.entries(this.cskData)) {\n          const key = _key as keyof CSKData;\n          const { alt, ctrl, meta, shift } = shortcutDatum!.modifiers;\n          if (\n            ev.altKey === alt &&\n            ev.ctrlKey === ctrl &&\n            ev.metaKey === meta &&\n            ev.shiftKey === shift &&\n            ev.key === shortcutDatum!.key\n          ) {\n            commands[key].command(ev);\n          }\n        }\n      }\n    });\n  }\n}\n","/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { createEffect, createSignal } from \"solid-js\";\nimport type {} from \"solid-styled-jsx\";\n\nexport const [showStatusbar, setShowStatusbar] = createSignal(\n  Services.prefs.getBoolPref(\"browser.display.statusbar\", false),\n);\nexport class gFloorpStatusBar {\n  private static instance: gFloorpStatusBar;\n  public static getInstance() {\n    if (!gFloorpStatusBar.instance) {\n      gFloorpStatusBar.instance = new gFloorpStatusBar();\n    }\n    return gFloorpStatusBar.instance;\n  }\n\n  private get statusbarEnabled() {\n    return Services.prefs.getBoolPref(\"browser.display.statusbar\", false);\n  }\n\n  constructor() {\n    window.CustomizableUI.registerArea(\"statusBar\", {\n      type: window.CustomizableUI.TYPE_TOOLBAR,\n      defaultPlacements: [\"screenshot-button\", \"fullscreen-button\"],\n    });\n    window.CustomizableUI.registerToolbarNode(\n      document.getElementById(\"statusBar\"),\n    );\n\n    createEffect(() => {\n      const statuspanel_label = document.getElementById(\n        \"statuspanel-label\",\n      ) as XULElement;\n      const statuspanel = document.getElementById(\"statuspanel\") as XULElement;\n      const statusText = document.getElementById(\"status-text\") as XULElement;\n      const observer = new MutationObserver(() => {\n        if (statuspanel.getAttribute(\"inactive\") === \"true\" && statusText) {\n          statusText.setAttribute(\"hidden\", \"true\");\n        } else {\n          statusText?.removeAttribute(\"hidden\");\n        }\n      });\n\n      Services.prefs.setBoolPref(\"browser.display.statusbar\", showStatusbar());\n      if (showStatusbar()) {\n        statusText?.appendChild(statuspanel_label!);\n        observer.observe(statuspanel, { attributes: true });\n      } else {\n        statuspanel?.appendChild(statuspanel_label!);\n        observer?.disconnect();\n      }\n    });\n\n    //move elem to bottom of window\n    document.body?.appendChild(document.getElementById(\"statusBar\")!);\n    this.observeStatusbar();\n  }\n\n  private observeStatusbar() {\n    Services.prefs.addObserver(\"browser.display.statusbar\", () =>\n      setShowStatusbar(() => this.statusbarEnabled),\n    );\n  }\n}\n","/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { showStatusbar, setShowStatusbar } from \"./browser-statusbar\";\n\nexport function ContextMenu() {\n  return (\n    <xul:menuitem\n      data-l10n-id=\"status-bar\"\n      label=\"Status Bar\"\n      type=\"checkbox\"\n      id=\"toggle_statusBar\"\n      checked={showStatusbar()}\n      onCommand={() => setShowStatusbar((value) => !value)}\n    />\n  );\n}\n","/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { showStatusbar } from \"./browser-statusbar\";\nimport statusbarStyle from \"./statusbar.pcss?inline\";\n\nexport function StatusBar() {\n  return (\n    <>\n      <xul:toolbar\n        id=\"statusBar\"\n        toolbarname=\"Status bar\"\n        customizable=\"true\"\n        class={`browser-toolbar customization-target ${\n          showStatusbar() ? \"\" : \"collapsed\"\n        }`}\n        mode=\"icons\"\n        context=\"toolbar-context-menu\"\n        accesskey=\"A\"\n      >\n        <xul:hbox\n          id=\"status-text\"\n          align=\"center\"\n          flex=\"1\"\n          class=\"statusbar-padding\"\n        />\n      </xul:toolbar>\n      <style jsx>{statusbarStyle}</style>\n    </>\n  );\n}\n","/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { insert, render } from \"@solid-xul/solid-xul\";\nimport { gFloorpStatusBar } from \"./browser-statusbar\";\nimport { ContextMenu } from \"./context-menu\";\nimport { StatusBar } from \"./statusbar\";\n\nexport function initStatusbar() {\n  render(() => <StatusBar />, document.getElementById(\"navigator-toolbox\"));\n  insert(\n    document.getElementById(\"toolbar-context-menu\"),\n    () => <ContextMenu />,\n    document.getElementById(\"viewToolbarsMenuSeparator\"),\n  );\n\n  // Initialize statusbar\n  gFloorpStatusBar.getInstance();\n}\n","/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nexport function ContextMenu(id: string, l10n: string, runFunction: () => void) {\n  return (\n    <xul:menuitem\n      data-l10n-id={l10n}\n      label={l10n}\n      id={id}\n      onCommand={runFunction}\n    />\n  );\n}\n","import { insert } from \"@solid-xul/solid-xul\";\nimport { ContextMenu } from \"./context-menu\";\nimport type { JSXElement } from \"solid-js\";\n\nexport const gFloorpContextMenu: {\n  initialized: boolean;\n  checkItems: (() => void)[];\n  contextMenuObserver: MutationObserver;\n  windowModalDialogElem: XULElement;\n  screenShotContextMenuItems: XULElement;\n  contentAreaContextMenu: XULElement;\n  pdfjsContextMenuSeparator: XULElement;\n  contextMenuSeparators: NodeListOf<XULElement>;\n  init: () => void;\n  addContextBox: (\n    id: string,\n    l10n: string,\n    insert: string,\n    runFunction: () => void,\n    checkID: string,\n    checkedFunction: () => void,\n  ) => void;\n  contextMenuObserverFunc: () => void;\n  addToolbarContentMenuPopupSet: (xulElement: JSXElement) => void;\n  onPopupShowing: () => void;\n} = {\n  initialized: false,\n  checkItems: [],\n  contextMenuObserver: new MutationObserver(() =>\n    gFloorpContextMenu.contextMenuObserverFunc(),\n  ),\n\n  get windowModalDialogElem() {\n    return document.getElementById(\"window-modal-dialog\") as XULElement;\n  },\n  get screenShotContextMenuItems() {\n    return document.getElementById(\"context-take-screenshot\") as XULElement;\n  },\n  get contentAreaContextMenu() {\n    return document.getElementById(\"contentAreaContextMenu\") as XULElement;\n  },\n  get pdfjsContextMenuSeparator() {\n    return document.getElementById(\"context-sep-pdfjs-selectall\") as XULElement;\n  },\n  get contextMenuSeparators() {\n    return document.querySelectorAll(\n      \"#contentAreaContextMenu > menuseparator\",\n    ) as NodeListOf<XULElement>;\n  },\n\n  init() {\n    if (this.initialized) {\n      return;\n    }\n    gFloorpContextMenu.contentAreaContextMenu.addEventListener(\n      \"popupshowing\",\n      gFloorpContextMenu.onPopupShowing,\n    );\n    this.initialized = true;\n  },\n\n  addContextBox(\n    id,\n    l10n,\n    insertElementId,\n    runFunction,\n    checkID,\n    checkedFunction,\n  ) {\n    const contextMenu = ContextMenu(id, l10n, runFunction);\n    const targetNode = document.getElementById(checkID) as XULElement;\n    const insertElement = document.getElementById(\n      insertElementId,\n    ) as XULElement;\n\n    insert(this.contentAreaContextMenu, () => contextMenu, insertElement);\n    this.contextMenuObserver.observe(targetNode, { attributes: true });\n    this.checkItems.push(checkedFunction);\n    this.contextMenuObserverFunc();\n  },\n\n  contextMenuObserverFunc() {\n    for (const checkItem of this.checkItems) {\n      checkItem();\n    }\n  },\n\n  addToolbarContentMenuPopupSet(JSXElem) {\n    insert(document.body, JSXElem, this.windowModalDialogElem);\n  },\n\n  onPopupShowing() {\n    if (!gFloorpContextMenu.screenShotContextMenuItems.hidden) {\n      gFloorpContextMenu.pdfjsContextMenuSeparator.hidden = false;\n\n      const nextSibling = gFloorpContextMenu.screenShotContextMenuItems\n        .nextSibling as XULElement;\n      if (nextSibling) {\n        nextSibling.hidden = false;\n      }\n    }\n\n    (async () => {\n      for (const contextMenuSeparator of gFloorpContextMenu.contextMenuSeparators) {\n        if (\n          contextMenuSeparator.nextSibling.hidden &&\n          contextMenuSeparator.previousSibling.hidden &&\n          contextMenuSeparator.id !== \"context-sep-navigation\" &&\n          contextMenuSeparator.id !== \"context-sep-pdfjs-selectall\"\n        ) {\n          contextMenuSeparator.hidden = true;\n        }\n      }\n    })();\n  },\n};\n","/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { gFloorpContextMenu } from \"./browser-context-menu\";\n\nexport function initBrowserContextMenu() {\n  gFloorpContextMenu.init();\n}\n","/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { CustomShortcutKey } from \"../components/custom-shortcut-key\";\nimport { initStatusbar } from \"./statusbar\";\nimport { initBrowserContextMenu } from \"./context-menu\";\n\nCustomShortcutKey.getInstance();\n\nwindow.SessionStore.promiseInitialized.then(() => {\n  initBrowserContextMenu();\n  initStatusbar();\n});\n"],"names":["showStatusbar","setShowStatusbar","createSignal","Services","prefs","getBoolPref","gFloorpStatusBar","getInstance","instance","statusbarEnabled","constructor","CustomizableUI","registerArea","type","window","TYPE_TOOLBAR","defaultPlacements","registerToolbarNode","document","getElementById","createEffect","statuspanel_label","statuspanel","statusText","observer","MutationObserver","getAttribute","setAttribute","removeAttribute","setBoolPref","appendChild","observe","attributes","disconnect","body","observeStatusbar","addObserver","ContextMenu","_el$","_$createElement","_$setProp","value","_$effect","_$p","StatusBar","_el$2","_$insertNode","_el$3","_$insert","statusbarStyle","initStatusbar","_$createComponent","insert","id","l10n","runFunction","gFloorpContextMenu","initialized","checkItems","contextMenuObserver","contextMenuObserverFunc","windowModalDialogElem","screenShotContextMenuItems","contentAreaContextMenu","pdfjsContextMenuSeparator","contextMenuSeparators","querySelectorAll","init","addEventListener","onPopupShowing","addContextBox","insertElementId","checkID","checkedFunction","contextMenu","targetNode","insertElement","push","checkItem","addToolbarContentMenuPopupSet","JSXElem","hidden","nextSibling","contextMenuSeparator","previousSibling","initBrowserContextMenu"],"mappings":"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"}